<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SRT Workplace</title>
  <link rel="icon" type="image/png" href="wp.png">
  <meta http-equiv="Permissions-Policy" content="clipboard-read/write=*, geolocation=(self)">
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #fff; padding: 20px; }
    .container {
      max-width: 420px; background: rgba(34,34,34,0.85); border-radius: 5px; position: absolute; top: 20px; left: 20px;
      resize: both; overflow: hidden; border: 1px solid rgba(255,255,255,0.3); transition: opacity 0.3s;
    }
    h2 { font-weight: 300; font-size: 20px; padding: 10px; background: rgba(51,51,51,0.8); color: #fff; display: flex; justify-content: space-between; }
    .header-buttons button { background: transparent; color: #fff; border: none; font-size: 18px; cursor: pointer; }
    .header-buttons button:hover { color: #4285f4; }
    input, .result-box { width: 100%; padding: 8px; margin: 6px 0; border: 1px solid #555; border-radius: 4px; background: #000; color: #fff; font-size: 14px; }
    .result-box { white-space: pre-line; user-select: text; cursor: pointer; }
    .result-box:hover { background: #444; }
    .slider-container { margin-top: 10px; text-align: center; padding: 10px 0; }
    .slider { width: 100%; height: 6px; background: #444; border-radius: 3px; cursor: pointer; -webkit-appearance: none; }
    .slider::-webkit-slider-thumb { width: 14px; height: 14px; background: #fff; border-radius: 50%; border: 2px solid #888; }
    .slider::-moz-range-thumb { width: 14px; height: 14px; background: #fff; border-radius: 50%; border: 2px solid #888; }
  </style>
</head>
<body>
<div class="container" id="container">
  <h2 id="dragHandle">JOB COUNT
    <div class="header-buttons">
      <button id="closeButton" onclick="closeCalculator()">❌</button>
    </div>
  </h2>
  <input type="number" id="break1" placeholder="1st Break" oninput="saveAndCalculate()">
  <input type="number" id="lunch" placeholder="Lunch" oninput="saveAndCalculate()">
  <input type="number" id="break2" placeholder="2nd Break" oninput="saveAndCalculate()">
  <input type="number" id="eos" placeholder="EOS" oninput="saveAndCalculate()">
  <input type="text" id="station" placeholder="Station#" oninput="saveAndCalculate()">
  <div class="result-box" id="resultBox" onclick="copyToClipboard()">Click to Copy</div>

  <!-- Transparency Slider -->
  <div class="slider-container">
    <input type="range" id="transparencySlider" class="slider" min="0" max="100" value="85" oninput="updateTransparency()">
  </div>
</div>

<script>
// Fields
const fields = ['break1', 'lunch', 'break2', 'eos', 'station'];
const container = document.getElementById('container');
const resultBox = document.getElementById('resultBox');
const transparencySlider = document.getElementById('transparencySlider');

// Drag functionality
let isDragging = false, offsetX = 0, offsetY = 0;
document.getElementById('dragHandle').addEventListener('mousedown', e => {
  isDragging = true;
  offsetX = e.clientX - container.offsetLeft;
  offsetY = e.clientY - container.offsetTop;
  document.addEventListener('mousemove', onDrag);
  document.addEventListener('mouseup', () => {
    isDragging = false;
    document.removeEventListener('mousemove', onDrag);
  });
});

function onDrag(e) {
  if (isDragging) {
    container.style.left = `${e.clientX - offsetX}px`;
    container.style.top = `${e.clientY - offsetY}px`;
  }
}

// Close functionality
function closeCalculator() {
  container.style.display = 'none';
}

// Load saved data
window.addEventListener('DOMContentLoaded', () => {
  fields.forEach(f => {
    const value = localStorage.getItem(f);
    if (value) document.getElementById(f).value = value;
  });
  calculate();
});

// Save and calculate
function saveAndCalculate() {
  const isAnyInputFilled = fields.some(id => document.getElementById(id).value.trim());
  fields.forEach(id => {
    const value = document.getElementById(id).value;
    if (isAnyInputFilled) localStorage.setItem(id, value);
    else localStorage.removeItem(id);
  });
  calculate();
}

// Calculate
function calculate() {
  const values = fields.map(id => id === "station" ? document.getElementById(id).value : parseInt(document.getElementById(id).value) || 0);
  const [b1, l, b2, e, station] = values;
  const res1 = b1 ? b1 : "", res2 = l ? (l - b1) : "", res3 = b2 ? (b2 - l) : "", res4 = e ? (e - b2) : "";
  const lines = [];
  if (e > 0) {
    const today = new Date();
    const date = `${String(today.getMonth() + 1).padStart(2, '0')}/${String(today.getDate()).padStart(2, '0')}/${today.getFullYear()}`;
    lines.push(`EOD Report ${date}`, "");
  }
  lines.push("Jobcount");
  if (res1) lines.push(`1st Break: ${res1}`);
  if (res2) lines.push(`Lunch: ${res2}`);
  if (res3) lines.push(`2nd Break: ${res3}`);
  if (res4) lines.push(`EOS: ${res4}`);
  if (e > 0) {
    lines.push(`Total: ${e}`);
    if (station) lines.push("", `Station#: ${station}`);
    lines.push("𝘖𝘯 𝘵𝘪𝘮𝘦 𝘵𝘢𝘨𝘨𝘪𝘯𝘨, 𝘕𝘖 𝘖𝘉 𝘢𝘯𝘥 𝘕𝘖 𝘰𝘷𝘦𝘳 𝘭𝘂𝘯𝘤𝘩");
    lines.push("𝘊𝘰𝘮𝘱𝘭𝘦𝘵𝘦 𝘈𝘴𝘴𝘦𝘵𝘴: 𝘕𝘰 𝘋𝘢𝘮𝘢𝘨𝘦𝘴 & 𝘞𝘪𝘵𝘩𝘰𝘶𝘵 𝘗𝘳𝘪𝘷𝘢𝘤𝘺 𝘚𝘤𝘳𝘦𝘦𝘯");
  }
  resultBox.textContent = lines.join("\n");
}

// Transparency slider
function updateTransparency() {
  container.style.opacity = transparencySlider.value / 100;
}

// Copy functionality
function copyToClipboard() {
  const text = resultBox.textContent;
  const textarea = document.createElement('textarea');
  textarea.value = text;
  document.body.appendChild(textarea);
  textarea.select();
  document.execCommand('copy');
  document.body.removeChild(textarea);
  alert("Copied to clipboard!");
}
</script>
</body>
</html>
